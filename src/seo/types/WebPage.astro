---
interface Props {
  title: string;
  description: string;
  imageURL: URL;
  url: URL;
  datePublished: string;
  dateModified: string;
  siteName: string;
}

const {
  title,
  description,
  datePublished,
  dateModified,
  imageURL,
  url,
  siteName,
} = Astro.props;
const basePath = url.origin;
const relativePath = url.pathname;

// Generate breadcrumbs based on currentPath
const generateBreadcrumbs = (path: string) => {
  const parts = path.split("/").filter(Boolean);
  return [
    {
      "@type": "ListItem",
      position: 1,
      name: "Home",
      item: basePath,
    },
    ...parts.map((part, index) => ({
      "@type": "ListItem",
      position: index + 2,
      name: part
        .split("-")
        .map((word) => word.charAt(0).toUpperCase() + word.slice(1))
        .join(" "),
      item: new URL(parts.slice(0, index + 1).join("/"), basePath).toString(),
    })),
  ];
};

const jsonLd = {
  "@id": `${url}#webpage`,
  "@context": "https://schema.org",
  "@type": "WebPage",
  name: title,
  description: description,
  url: url.toString(),
  isPartOf: {
    "@type": "WebSite",
    "@id": `${basePath}/#website`,
    name: siteName,
    url: basePath,
  },
  breadcrumb: {
    "@type": "BreadcrumbList",
    itemListElement: generateBreadcrumbs(relativePath),
  },
  mainContentOfPage: {
    "@type": "WebPageElement",
    isPartOf: {
      "@id": `${url}#webpage`,
    },
  },
  primaryImageOfPage: {
    "@type": "ImageObject",
    url: imageURL.toString(),
  },
};
---

<script
  is:inline
  type="application/ld+json"
  set:html={JSON.stringify(jsonLd)}
/>
