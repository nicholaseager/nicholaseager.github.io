---
interface Props {
  id: string;
  name: string;
  url: string;
  datePublished: string;
  dateModified: string;
  author: {
    name: string;
    url: string | URL;
  };
  audience?: {
    type: string;
  };
  educationalLevel?: string;
  location?: {
    name: string;
    latitude?: string;
    longitude?: string;
    mapId?: string;
  };
}

const {
  id,
  name,
  url,
  datePublished,
  dateModified,
  author,
  audience,
  educationalLevel,
  location,
} = Astro.props;

const jsonLd = {
  "@id": id,
  "@context": "https://schema.org",
  "@type": "CreativeWork",
  name,
  url,
  datePublished,
  dateModified,
  author: {
    "@type": "Person",
    name: author.name,
    url: author.url,
  },
  ...(audience && {
    audience: {
      "@type": "Audience",
      audienceType: audience.type,
    },
  }),
  ...(educationalLevel && { educationalLevel }),
  ...(location && {
    contentLocation: {
      "@type": "Place",
      name: location.name,
      ...(location.latitude &&
        location.longitude && {
          geo: {
            "@type": "GeoCoordinates",
            latitude: location.latitude,
            longitude: location.longitude,
          },
        }),
      ...(location.mapId && {
        map: `https://www.google.com/maps/d/viewer?mid=${location.mapId}`,
      }),
    },
  }),
};
---

<script
  is:inline
  type="application/ld+json"
  set:html={JSON.stringify(jsonLd)}
/>
