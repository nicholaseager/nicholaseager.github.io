---
import { getCollection } from "astro:content";
import Gallery from "../../../layouts/Gallery.astro";

export async function getStaticPaths() {
  const locations = await getCollection("locations");
  const photos = await getCollection("photos");
  return locations.map((gallery) => ({
    params: { slug: gallery.id },
    props: {
      gallery: gallery.data,
      photos: photos
        .filter((photo) => gallery.data.photoSlugs.includes(photo.data.slug))
        .map((p) => p.data),
    },
  }));
}

const { gallery, photos } = Astro.props;
---

<Gallery
  title={gallery.title}
  description={gallery.description}
  content={gallery.content}
  date={gallery.date}
  modified_date={gallery.modified_date}
  photos={photos}
  previewPhoto={photos[0]}
/>
