---
import { getCollection } from "astro:content";

import PhotoGrid from "../../../../components/photos/PhotoGrid";
import Page from "../../../../layouts/Page.astro";
import GallerySEO from "../../../../seo/GallerySEO.astro";

export async function getStaticPaths() {
  const photoLocations = await getCollection("photoLocations");

  // Filter to only get country locations (those without country/region format in id)
  const countries = photoLocations
    .filter((l) => !l.data.id.includes("/"))
    .map((l) => l.data);

  // Transform countries into Astro path params
  return countries.map((country) => {
    const id = country.id;
    return {
      params: { country: id },
      props: {
        ...country,
      },
    };
  });
}

const { title, description, photos, previewImage } = Astro.props;
---

<Page title={title} description={description}>
  <PhotoGrid client:visible photos={photos} />
  <GallerySEO
    title={title}
    description={description}
    images={photos}
    image={previewImage}
  />
</Page>
